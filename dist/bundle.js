(()=>{"use strict";const e=(e,t,n="")=>(e.classList.add(t),e.textContent=n,function(e,t){e.append(t)}),t=e=>JSON.stringify(e),n=e=>JSON.parse(e),o=e=>{let t=new Date(e);const n=864e5;return Date.now()-e<n?"Сегодня, "+t.toLocaleTimeString(["ru-RU"],{hour:"2-digit",minute:"2-digit"}):Date.now()-e>n&&Date.now()-e<1728e5?"Вчера, "+t.toLocaleTimeString(["ru-RU"],{hour:"2-digit",minute:"2-digit"}):[t.toLocaleTimeString(["ru-RU"],{day:"numeric",month:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]},l=e=>{let t=new Date,n=36e5*t.getHours()+6e4*t.getMinutes();return e.valueAsNumber-216e5+n};let m=[{id:1677853903e3,name:"cветлана",text:"Я, конечно, понимаю, что вам надо деньги зарабатывать, но нельзя же писать про шампуни!",stamp:1677853903e3,likedBy:["Skyler White","Saul Goodman","Jessie"]},{id:1678190743e3,name:"Игорь",text:"А что такого? Нормальный шампунь. Моя собака не жаловалась.",stamp:1678190743e3,likedBy:["Mike Ermantraut","Heisenberg","Tuco","Gus Fring"]},{id:1678255543e3,name:"cветлана",text:"Не знаю, юмор это или нет, мне всё равно! Так впаривать эту дрянь - возмутительно!",stamp:1678255543e3,likedBy:["Skyler White","Hector"]},{id:1678377943e3,name:"raygan228",text:"Кто-то тратит деньги на рекламу, а кого-то клиенты находят сами.",stamp:1678377943e3,likedBy:["Hank Schrader"]}];function a(e,t,n,o){let m=l(o);e.push({id:o.value?m:Date.now(),name:t.value,text:n.value,stamp:o.value?m:Date.now(),likedBy:[]})}function i(m,i,r){if(localStorage.getItem("comments")){let e=n(localStorage.getItem("comments"));a(e,m,i,r),localStorage.setItem("comments",t(e))}else{localStorage.setItem("comments","[]");let e=n(localStorage.getItem("comments"));a(e,m,i,r),localStorage.setItem("comments",t(e))}let s=document.createElement("li"),u=n(localStorage.getItem("comments"));s.commentId=u[u.length-1].id,e(s,"list__item")(c,s);let d=document.createElement("div");e(d,"item__name",m.value)(s,d);let _=document.createElement("div");e(_,"item__text",i.value)(s,_);let g=document.createElement("div");e(g,"item__info")(s,g);let S=document.createElement("div");e(S,"info__date",r.valueAsNumber?o(l(r)):o(Date.now()))(g,S);let f=document.createElement("div");e(f,"info__buttons")(g,f);let v=document.createElement("button");e(v,"buttons__like")(f,v);let E=document.createElement("span");e(E,"info__likes",0)(f,E);let b=document.createElement("button");e(b,"buttons__delete")(f,b)}let c=document.querySelector(".comments__list");m=localStorage.getItem("comments")?n(localStorage.getItem("comments")):[],function(){let e=document.querySelector(".comments__list"),o=document.querySelector(".form"),l=document.querySelector(".form__name"),m=document.querySelector(".form__text"),a=document.querySelector(".form__date"),c=document.querySelector(".form__submit");o.addEventListener("keydown",(e=>{(e.target.classList.contains("form__name")||e.target.classList.contains("form__text")||e.target.classList.contains("form__date"))&&"Enter"===e.key&&(e.preventDefault(),i(l,m,a),l.value="",m.value="",a.value="")})),c.addEventListener("click",(()=>{i(l,m,a),l.value="",m.value="",a.value=""})),e.addEventListener("click",(function(e){if(e.target.classList.contains("buttons__delete")){let o=e.target.closest(".list__item");o.remove(),function(e){let o=n(localStorage.getItem("comments"));o=o.filter((t=>t.id!==e)),localStorage.setItem("comments",t(o))}(o.commentId)}})),e.addEventListener("click",(function(e){!function(e){e.target.classList.contains("buttons__like")&&(e.target.classList.toggle("like__active"),e.target.classList.contains("like__active")?e.target.nextSibling.textContent=Number(e.target.nextSibling.textContent)+1:e.target.nextSibling.textContent=Number(e.target.nextSibling.textContent)-1)}(e)}))}(),function(e){if(e&&e.length){let n=t(e);localStorage.setItem("comments",n)}else localStorage.clear()}(m),localStorage.getItem("comments")&&function(t){for(let n of t){let t=document.createElement("li");t.commentId=n.stamp,e(t,"list__item")(c,t);let l=document.createElement("div");e(l,"item__name",n.name)(t,l);let m=document.createElement("div");e(m,"item__text",n.text)(t,m);let a=document.createElement("div");e(a,"item__info")(t,a);let i=document.createElement("div");e(i,"info__date",`${o(n.stamp)}`)(a,i);let r=document.createElement("div");e(r,"info__buttons")(a,r);let s=document.createElement("button");e(s,"buttons__like")(r,s);let u=document.createElement("span");e(u,"info__likes",n.likedBy.length)(r,u);let d=document.createElement("button");e(d,"buttons__delete")(r,d)}}(n(localStorage.getItem("comments")))})();